// ============================================================================================= //
//                                            MIXINS                                             //
// ============================================================================================= //

@use "sass:meta";
@use "sass:string";
@use "./functions";

///
/// @example
///     @include selector.prefix(md) { background: darkcyan; }
///     // .md:foo { background: darkcyan; }
///     @include selector.suffix(md) { background: darkcyan; }
///     // .foo:md { background: darkcyan; }
///
/// @link https://sparkbox.com/foundry/responsive_class_suffixes_automating_classes_with_sass_mixins_and_sass_maps
///
@mixin prefix($key, $divider: ":") {
    $selector: #{&};
    $prefix: string.slice($selector, 1, $end-at: 1);

    @if $prefix != "." {
        @error "Invalid `#{$selector}` selector. Choose a class selector instead.";
    } @else {
        $selector: string.slice($selector, 2);
    }

    $first-character: functions.number(string.slice($key, 1, $end-at: 1));

    @if meta.type-of($first-character) == "number" {
        $value: string.unquote($key);
        $key: functions.replace(\3 #{$value}, " ");
    }

    @at-root .#{$key}#{string.unquote("\\") + string.unquote($divider)}#{$selector} {
        @content;
    }
}

@mixin suffix($key, $divider: ":") {
    $selector: #{&};
    $prefix: string.slice($selector, 1, $end-at: 1);

    @if $prefix != "." {
        @error "Invalid `#{$selector}` selector. Choose a class selector instead.";
    }

    $first-character: functions.number(string.slice($key, 1, $end-at: 1));

    @if meta.type-of($first-character) == "number" {
        $value: string.unquote($key);
        $key: functions.replace(\3 #{$value}, " ");
    }

    &#{string.unquote("\\") + string.unquote($divider)}#{$key} {
        @content;
    }
}
